<script>
    import { fly, fade } from 'svelte/transition';
    import './main.css';
    import { format } from 'api/formatter'
    import { storeSettings } from 'store/settings'
    import { executeClient } from 'api/rage'

    let notifications = [];

/*     let notifications = [{
        type: "black",
		title: "ЕTitle",
		elements: "ХУй",
		timeout: 12,
		endtime: -1,
		percent: 100,
    }]; */

    window.notification = (json) => {
        if (json) {
            json = JSON.parse(json);
            for (let i = 0; i < json.length; i++) {
                if (typeof json [i] === "object")
                    json [i].text = format("parse", json [i].text);
            }
        }

        notifications = json;
    }

    window.notificationAdd = (type, _, msg, time) => {
        executeClient ("notify", type, _, msg, time);
    }

    const onDelete = (index) => {
        executeClient ("notifyClear", index);
    }

    // export let night;

</script>
{#if notifications.length > 0}
    <div class="notilistpi">
        {#each new Array($storeSettings.notifCount <= 1 ? 1 : $storeSettings.notifCount) as _, index}
            {#if notifications[index]}
                <div class="notpiblock {notifications[index].type}">
                    <div class="leftnotipi">
                        {#if notifications[index].type === "error"}
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22.3229 17.5898L13.9319 4.14002C13.7289 3.81112 13.4453 3.5395 13.1079 3.35089C12.7705 3.16228 12.3906 3.06294 12.0041 3.06226C11.6176 3.06158 11.2373 3.1596 10.8992 3.34703C10.5612 3.53445 10.2766 3.80508 10.0724 4.13327L1.66794 17.6055C1.47253 17.9482 1.3698 18.336 1.36987 18.7305C1.36995 19.125 1.47283 19.5127 1.66838 19.8553C1.86392 20.198 2.14538 20.4837 2.48502 20.6845C2.82465 20.8852 3.21073 20.9939 3.60519 21H20.3947C20.7906 20.9937 21.178 20.884 21.5184 20.6818C21.8589 20.4795 22.1405 20.1918 22.3354 19.8471C22.5303 19.5024 22.6317 19.1127 22.6295 18.7168C22.6273 18.3208 22.5216 17.9323 22.3229 17.5898Z" fill="#F21626"/>
                                <path d="M11.3151 13.968L11.1156 10.986C11.0766 10.386 10.8719 9.41623 11.3301 8.92873C11.6789 8.55373 12.5046 8.48923 12.7551 9.00898C12.9681 9.61973 13.0152 10.2761 12.8916 10.911L12.6246 13.9807C12.6131 14.2697 12.5499 14.5542 12.4379 14.8207C12.3938 14.907 12.3269 14.9795 12.2445 15.0305C12.1622 15.0815 12.0674 15.109 11.9706 15.11C11.8737 15.111 11.7784 15.0855 11.695 15.0362C11.6116 14.987 11.5432 14.9158 11.4974 14.8305C11.3918 14.5543 11.3303 14.2633 11.3151 13.968ZM12.0059 18.0652C11.7694 18.0639 11.5422 17.9725 11.3707 17.8097C11.1992 17.6468 11.0962 17.4247 11.0826 17.1886C11.0691 16.9525 11.146 16.7201 11.2977 16.5386C11.4494 16.3572 11.6646 16.2404 11.8994 16.212C12.0255 16.1967 12.1534 16.2075 12.2753 16.2436C12.3971 16.2797 12.5102 16.3403 12.6077 16.4218C12.7052 16.5034 12.7849 16.604 12.842 16.7175C12.8991 16.831 12.9323 16.955 12.9396 17.0819C12.9468 17.2087 12.9281 17.3357 12.8844 17.4551C12.8407 17.5744 12.773 17.6835 12.6855 17.7756C12.598 17.8678 12.4926 17.941 12.3757 17.9908C12.2588 18.0406 12.1329 18.0659 12.0059 18.0652Z" fill="white"/>
                            </svg>
                        {/if}
                        {#if notifications[index].type === "success"}
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12.5 21C17.1944 21 21 17.1944 21 12.5C21 7.80558 17.1944 4 12.5 4C7.80558 4 4 7.80558 4 12.5C4 17.1944 7.80558 21 12.5 21Z" fill="#34B67C"/>
                                <path d="M10.4999 17.5001C10.2347 17.5 9.98041 17.3946 9.79292 17.2071L7.79292 15.2071C7.61076 15.0185 7.50997 14.7659 7.51224 14.5037C7.51452 14.2415 7.61969 13.9907 7.8051 13.8053C7.99051 13.6199 8.24132 13.5147 8.50352 13.5124C8.76572 13.5101 9.01832 13.6109 9.20692 13.7931L10.4434 15.0296L15.7404 8.85008C15.8243 8.7455 15.9283 8.65884 16.0463 8.59526C16.1643 8.53168 16.2938 8.49247 16.4273 8.47995C16.5607 8.46744 16.6953 8.48188 16.8231 8.52242C16.9509 8.56296 17.0692 8.62877 17.171 8.71594C17.2728 8.80311 17.3561 8.90986 17.4158 9.02984C17.4755 9.14982 17.5106 9.28059 17.5188 9.41438C17.527 9.54816 17.5082 9.68223 17.4636 9.80862C17.4189 9.935 17.3493 10.0511 17.2589 10.1501L11.2589 17.1501C11.1659 17.2606 11.0497 17.3493 10.9185 17.4098C10.7873 17.4703 10.6444 17.5011 10.4999 17.5001Z" fill="white"/>
                            </svg>    
                        {/if}
                        {#if notifications[index].type === "information"}
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22.3229 17.5898L13.9319 4.14002C13.7289 3.81112 13.4453 3.5395 13.1079 3.35089C12.7705 3.16228 12.3906 3.06294 12.0041 3.06226C11.6176 3.06158 11.2373 3.1596 10.8992 3.34703C10.5612 3.53445 10.2766 3.80508 10.0724 4.13327L1.66794 17.6055C1.47253 17.9482 1.3698 18.336 1.36987 18.7305C1.36995 19.125 1.47283 19.5127 1.66838 19.8553C1.86392 20.198 2.14538 20.4837 2.48502 20.6845C2.82465 20.8852 3.21073 20.9939 3.60519 21H20.3947C20.7906 20.9937 21.178 20.884 21.5184 20.6818C21.8589 20.4795 22.1405 20.1918 22.3354 19.8471C22.5303 19.5024 22.6317 19.1127 22.6295 18.7168C22.6273 18.3208 22.5216 17.9323 22.3229 17.5898Z" fill="#FFD54F"/>
                                <path d="M11.3151 13.968L11.1156 10.986C11.0766 10.386 10.8719 9.41623 11.3301 8.92873C11.6789 8.55373 12.5046 8.48923 12.7551 9.00898C12.9681 9.61973 13.0152 10.2761 12.8916 10.911L12.6246 13.9807C12.6131 14.2697 12.5499 14.5542 12.4379 14.8207C12.3938 14.907 12.3269 14.9795 12.2445 15.0305C12.1622 15.0815 12.0674 15.109 11.9706 15.11C11.8737 15.111 11.7784 15.0855 11.695 15.0362C11.6116 14.987 11.5432 14.9158 11.4974 14.8305C11.3918 14.5543 11.3303 14.2633 11.3151 13.968ZM12.0059 18.0652C11.7694 18.0639 11.5422 17.9725 11.3707 17.8097C11.1992 17.6468 11.0962 17.4247 11.0826 17.1886C11.0691 16.9525 11.146 16.7201 11.2977 16.5386C11.4494 16.3572 11.6646 16.2404 11.8994 16.212C12.0255 16.1967 12.1534 16.2075 12.2753 16.2436C12.3971 16.2797 12.5102 16.3403 12.6077 16.4218C12.7052 16.5034 12.7849 16.604 12.842 16.7175C12.8991 16.831 12.9323 16.955 12.9396 17.0819C12.9468 17.2087 12.9281 17.3357 12.8844 17.4551C12.8407 17.5744 12.773 17.6835 12.6855 17.7756C12.598 17.8678 12.4926 17.941 12.3757 17.9908C12.2588 18.0406 12.1329 18.0659 12.0059 18.0652Z" fill="black"/>
                            </svg>
                        {/if}
                        {#if notifications[index].type === "alert"}
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22.3229 17.5898L13.9319 4.14002C13.7289 3.81112 13.4453 3.5395 13.1079 3.35089C12.7705 3.16228 12.3906 3.06294 12.0041 3.06226C11.6176 3.06158 11.2373 3.1596 10.8992 3.34703C10.5612 3.53445 10.2766 3.80508 10.0724 4.13327L1.66794 17.6055C1.47253 17.9482 1.3698 18.336 1.36987 18.7305C1.36995 19.125 1.47283 19.5127 1.66838 19.8553C1.86392 20.198 2.14538 20.4837 2.48502 20.6845C2.82465 20.8852 3.21073 20.9939 3.60519 21H20.3947C20.7906 20.9937 21.178 20.884 21.5184 20.6818C21.8589 20.4795 22.1405 20.1918 22.3354 19.8471C22.5303 19.5024 22.6317 19.1127 22.6295 18.7168C22.6273 18.3208 22.5216 17.9323 22.3229 17.5898Z" fill="#FFD54F"/>
                                <path d="M11.3151 13.968L11.1156 10.986C11.0766 10.386 10.8719 9.41623 11.3301 8.92873C11.6789 8.55373 12.5046 8.48923 12.7551 9.00898C12.9681 9.61973 13.0152 10.2761 12.8916 10.911L12.6246 13.9807C12.6131 14.2697 12.5499 14.5542 12.4379 14.8207C12.3938 14.907 12.3269 14.9795 12.2445 15.0305C12.1622 15.0815 12.0674 15.109 11.9706 15.11C11.8737 15.111 11.7784 15.0855 11.695 15.0362C11.6116 14.987 11.5432 14.9158 11.4974 14.8305C11.3918 14.5543 11.3303 14.2633 11.3151 13.968ZM12.0059 18.0652C11.7694 18.0639 11.5422 17.9725 11.3707 17.8097C11.1992 17.6468 11.0962 17.4247 11.0826 17.1886C11.0691 16.9525 11.146 16.7201 11.2977 16.5386C11.4494 16.3572 11.6646 16.2404 11.8994 16.212C12.0255 16.1967 12.1534 16.2075 12.2753 16.2436C12.3971 16.2797 12.5102 16.3403 12.6077 16.4218C12.7052 16.5034 12.7849 16.604 12.842 16.7175C12.8991 16.831 12.9323 16.955 12.9396 17.0819C12.9468 17.2087 12.9281 17.3357 12.8844 17.4551C12.8407 17.5744 12.773 17.6835 12.6855 17.7756C12.598 17.8678 12.4926 17.941 12.3757 17.9908C12.2588 18.0406 12.1329 18.0659 12.0059 18.0652Z" fill="black"/>
                            </svg>
                        {/if} 
                        {#if notifications[index].type === "warning"}
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22.3229 17.5898L13.9319 4.14002C13.7289 3.81112 13.4453 3.5395 13.1079 3.35089C12.7705 3.16228 12.3906 3.06294 12.0041 3.06226C11.6176 3.06158 11.2373 3.1596 10.8992 3.34703C10.5612 3.53445 10.2766 3.80508 10.0724 4.13327L1.66794 17.6055C1.47253 17.9482 1.3698 18.336 1.36987 18.7305C1.36995 19.125 1.47283 19.5127 1.66838 19.8553C1.86392 20.198 2.14538 20.4837 2.48502 20.6845C2.82465 20.8852 3.21073 20.9939 3.60519 21H20.3947C20.7906 20.9937 21.178 20.884 21.5184 20.6818C21.8589 20.4795 22.1405 20.1918 22.3354 19.8471C22.5303 19.5024 22.6317 19.1127 22.6295 18.7168C22.6273 18.3208 22.5216 17.9323 22.3229 17.5898Z" fill="#FFD54F"/>
                                <path d="M11.3151 13.968L11.1156 10.986C11.0766 10.386 10.8719 9.41623 11.3301 8.92873C11.6789 8.55373 12.5046 8.48923 12.7551 9.00898C12.9681 9.61973 13.0152 10.2761 12.8916 10.911L12.6246 13.9807C12.6131 14.2697 12.5499 14.5542 12.4379 14.8207C12.3938 14.907 12.3269 14.9795 12.2445 15.0305C12.1622 15.0815 12.0674 15.109 11.9706 15.11C11.8737 15.111 11.7784 15.0855 11.695 15.0362C11.6116 14.987 11.5432 14.9158 11.4974 14.8305C11.3918 14.5543 11.3303 14.2633 11.3151 13.968ZM12.0059 18.0652C11.7694 18.0639 11.5422 17.9725 11.3707 17.8097C11.1992 17.6468 11.0962 17.4247 11.0826 17.1886C11.0691 16.9525 11.146 16.7201 11.2977 16.5386C11.4494 16.3572 11.6646 16.2404 11.8994 16.212C12.0255 16.1967 12.1534 16.2075 12.2753 16.2436C12.3971 16.2797 12.5102 16.3403 12.6077 16.4218C12.7052 16.5034 12.7849 16.604 12.842 16.7175C12.8991 16.831 12.9323 16.955 12.9396 17.0819C12.9468 17.2087 12.9281 17.3357 12.8844 17.4551C12.8407 17.5744 12.773 17.6835 12.6855 17.7756C12.598 17.8678 12.4926 17.941 12.3757 17.9908C12.2588 18.0406 12.1329 18.0659 12.0059 18.0652Z" fill="black"/>
                            </svg>
                        {/if}                     
                    </div>
                    <div class="rightnotipi">
                        <p>{@html notifications[index].elements}</p>
                    </div>
                </div>
            {/if}
        {/each}
    </div>
{/if}

